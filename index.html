<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CyberGator1 - Threat Hunting Command Center</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <style>
    :root{--bg-primary:#fff;--bg-secondary:#f8f9fa;--bg-tertiary:#f1f3f5;--surface:#fff;--text-primary:#202124;--text-secondary:#5f6368;--text-tertiary:#80868b;--border:#e8eaed;--border-strong:#dadce0;--accent:#1a73e8;--accent-hover:#1557b0;--accent-light:#e8f0fe;--success:#137333;--success-light:#e6f4ea;--warning:#f9ab00;--warning-light:#fef7e0;--danger:#d93025;--danger-light:#fce8e6;--info:#1967d2;--shadow-sm:0 1px 2px 0 rgba(60,64,67,.1);--shadow:0 1px 3px 0 rgba(60,64,67,.15);--radius:8px;--radius-lg:12px}*{box-sizing:border-box;margin:0;padding:0}body{background:var(--bg-secondary);color:var(--text-primary);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;line-height:1.6;font-size:15px}header{background:var(--surface);border-bottom:1px solid var(--border);padding:1rem 2rem;position:sticky;top:0;z-index:1000;box-shadow:var(--shadow-sm)}header .container{max-width:1400px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}header h1{color:var(--text-primary);font-size:1.5rem;font-weight:500;display:flex;align-items:center;gap:.5rem}header h1 i{color:var(--accent)}header time{color:var(--text-tertiary);font-size:.875rem}.nav-tabs{background:var(--surface);border-bottom:1px solid var(--border);position:sticky;top:65px;z-index:999;overflow-x:auto;scrollbar-width:none}.nav-tabs::-webkit-scrollbar{display:none}.nav-tabs .container{max-width:1400px;margin:0 auto;display:flex;gap:0;padding:0 2rem}.nav-tab{background:0 0;color:var(--text-secondary);border:none;border-bottom:2px solid transparent;padding:.875rem 1rem;cursor:pointer;transition:all .15s ease;font-size:.875rem;font-weight:500;white-space:nowrap}.nav-tab:hover{color:var(--accent);background:var(--accent-light)}.nav-tab.active{color:var(--accent);border-bottom-color:var(--accent)}.content{max-width:1400px;margin:0 auto;padding:2rem}.tab-content{display:none}.tab-content.active{display:block;animation:fadeIn .2s ease-in}@keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:1.5rem}.grid-full{grid-column:1/-1}section{background:var(--surface);border-radius:var(--radius-lg);padding:1.5rem;border:1px solid var(--border);box-shadow:var(--shadow-sm)}h2{color:var(--text-primary);font-size:1.125rem;font-weight:500;margin-bottom:1.25rem;display:flex;align-items:center;gap:.5rem}h2 i{color:var(--accent);font-size:1rem}h3{color:var(--text-primary);font-size:1rem;font-weight:500;margin-bottom:1rem}button,input,select,textarea{font-family:inherit;font-size:.875rem;border-radius:var(--radius);transition:all .15s ease}input,select,textarea{background:var(--surface);color:var(--text-primary);border:1px solid var(--border-strong);padding:.625rem .875rem;width:100%}input:hover,select:hover,textarea:hover{border-color:var(--text-tertiary)}input:focus,select:focus,textarea:focus{outline:0;border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-light)}textarea{min-height:120px;resize:vertical;font-family:Monaco,'Courier New',monospace;line-height:1.5}button{background:var(--surface);color:var(--text-primary);border:1px solid var(--border-strong);padding:.625rem 1rem;cursor:pointer;font-weight:500}button:hover{background:var(--bg-tertiary);border-color:var(--text-tertiary)}button.primary{background:var(--accent);color:#fff;border:none}button.primary:hover{background:var(--accent-hover)}pre{background:var(--bg-tertiary);border:1px solid var(--border);border-radius:var(--radius);padding:1rem;overflow-x:auto;font-size:.8125rem;line-height:1.5;position:relative;font-family:Monaco,'Courier New',monospace}.copy-btn{position:absolute;top:.5rem;right:.5rem;padding:.375rem .75rem;font-size:.75rem}.feed-container{max-height:700px;overflow-y:auto;display:flex;flex-direction:column;gap:1rem}.feed-item{background:var(--bg-secondary);padding:1.25rem;border-left:3px solid var(--accent);border-radius:var(--radius);transition:all .15s ease}.feed-item:hover{background:var(--accent-light);box-shadow:var(--shadow);transform:translateX(2px)}.feed-item a{color:var(--accent);text-decoration:none;display:block;font-weight:500;margin-bottom:.75rem;line-height:1.4;font-size:1rem}.feed-item a:hover{text-decoration:underline}.feed-item .description{color:var(--text-secondary);font-size:.9375rem;line-height:1.6;margin-bottom:.75rem}.feed-item .meta{color:var(--text-tertiary);font-size:.75rem;display:flex;align-items:center;gap:1rem;margin-bottom:.75rem}.feed-item .tags{display:flex;flex-wrap:wrap;gap:.5rem}.tag{background:var(--bg-tertiary);color:var(--text-secondary);padding:.25rem .625rem;border-radius:4px;font-size:.6875rem;font-weight:500;border:1px solid var(--border)}.tag.critical{background:var(--danger-light);color:var(--danger);border-color:var(--danger)}.tag.high{background:var(--warning-light);color:#b35800;border-color:var(--warning)}.tag.success{background:var(--success-light);color:var(--success);border-color:var(--success)}.threat-card{background:var(--surface);border:1px solid var(--border);border-left:4px solid var(--danger);padding:1.25rem;margin-bottom:1rem;border-radius:var(--radius);transition:all .15s ease}.threat-card:hover{box-shadow:var(--shadow)}.threat-card.critical{border-left-color:var(--danger)}.threat-card.high{border-left-color:var(--warning)}.threat-card.medium{border-left-color:var(--info)}.threat-card h4{color:var(--text-primary);font-size:.9375rem;font-weight:500;margin-bottom:.75rem}.threat-card .description{color:var(--text-secondary);font-size:.875rem;line-height:1.6;margin-bottom:.75rem}.threat-card .action{color:var(--text-secondary);font-size:.8125rem;padding-top:.75rem;border-top:1px solid var(--border);line-height:1.5}.threat-card .action strong{color:var(--accent)}.hypothesis-item{background:var(--bg-secondary);border:1px solid var(--border);border-left:3px solid var(--accent);padding:1.25rem;margin-bottom:1rem;border-radius:var(--radius)}.hypothesis-item h4{color:var(--text-primary);font-size:.9375rem;font-weight:500;margin-bottom:.75rem}.hypothesis-item p{color:var(--text-secondary);font-size:.875rem;line-height:1.5;margin-bottom:.5rem}.hypothesis-item .context{color:var(--text-secondary);font-size:.8125rem;padding-top:.75rem;border-top:1px solid var(--border);line-height:1.6}.osint-keyboard{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:.75rem}.osint-key{background:var(--surface);border:1px solid var(--border-strong);border-radius:var(--radius);padding:1rem;text-align:center;cursor:pointer;transition:all .15s ease;text-decoration:none;color:var(--text-primary);display:flex;flex-direction:column;align-items:center;gap:.375rem}.osint-key:hover{background:var(--accent);color:#fff;border-color:var(--accent);transform:translateY(-2px);box-shadow:var(--shadow)}.osint-key .letter{font-size:1.5rem;font-weight:600}.osint-key .tool-name{font-size:.6875rem;font-weight:500}.ioc-list{background:var(--bg-secondary);border:1px solid var(--border);border-radius:var(--radius);padding:1rem;max-height:400px;overflow-y:auto}.ioc-item{padding:.625rem 0;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;gap:1rem}.ioc-item:last-child{border-bottom:none}.ioc-type{color:var(--accent);font-size:.6875rem;font-weight:500;background:var(--accent-light);padding:.25rem .5rem;border-radius:4px;white-space:nowrap}.loading{text-align:center;padding:3rem;color:var(--text-tertiary)}.loading i{font-size:2rem;animation:spin 1s linear infinite;color:var(--accent)}@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}footer{text-align:center;color:var(--text-tertiary);padding:2rem;background:var(--surface);border-top:1px solid var(--border);font-size:.875rem}.filter-bar{display:flex;gap:.75rem;margin-bottom:1.25rem;flex-wrap:wrap}.filter-bar input,.filter-bar select{flex:1;min-width:180px}.filter-bar button{flex-shrink:0}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem;margin-bottom:1.5rem}.stat-card{background:var(--bg-secondary);border:1px solid var(--border);border-radius:var(--radius);padding:1.25rem;text-align:center}.stat-card .value{font-size:1.875rem;color:var(--accent);font-weight:600;line-height:1}.stat-card .label{font-size:.8125rem;color:var(--text-secondary);margin-top:.5rem}.btn-group{display:flex;gap:.75rem;flex-wrap:wrap}.alert{background:var(--accent-light);border:1px solid var(--accent);border-radius:var(--radius);padding:.875rem 1rem;margin-bottom:1rem;color:var(--text-primary);font-size:.875rem;display:flex;align-items:center;gap:.75rem}.alert i{color:var(--accent)}@media (max-width:768px){.grid{grid-template-columns:1fr}.nav-tabs .container{padding:0 1rem}.osint-keyboard{grid-template-columns:repeat(3,1fr)}header .container,.content{padding-left:1rem;padding-right:1rem}}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1><i class="fas fa-shield-alt"></i> CyberGator1</h1>
      <time id="clock"></time>
    </div>
  </header>

  <div class="nav-tabs">
    <div class="container">
      <button class="nav-tab active" onclick="switchTab('intel')"><i class="fas fa-globe"></i> Threat Intel</button>
      <button class="nav-tab" onclick="switchTab('hypothesis')"><i class="fas fa-brain"></i> AI Hypothesis</button>
      <button class="nav-tab" onclick="switchTab('osint')"><i class="fas fa-keyboard"></i> OSINT Tools</button>
      <button class="nav-tab" onclick="switchTab('ioc')"><i class="fas fa-fingerprint"></i> IOC Extractor</button>
      <button class="nav-tab" onclick="switchTab('translator')"><i class="fas fa-language"></i> Query Translator</button>
      <button class="nav-tab" onclick="switchTab('queries')"><i class="fas fa-search"></i> Detection Queries</button>
    </div>
  </div>

  <div class="content">
    <div id="tab-intel" class="tab-content active">
      <div class="grid">
        <section class="grid-full">
          <h2><i class="fas fa-newspaper"></i> Latest Cybersecurity News</h2>
          <div class="filter-bar">
            <select id="feedFilter" onchange="applyFeedFilters()">
              <option value="all">All Time</option>
              <option value="today">Today</option>
              <option value="24h" selected>Last 24 Hours</option>
              <option value="7d">Last 7 Days</option>
            </select>
            <input type="text" id="feedSearch" placeholder="Search articles..." oninput="applyFeedFilters()" />
            <button onclick="loadFeeds()"><i class="fas fa-sync-alt"></i> Refresh</button>
          </div>
          <div id="feedArea" class="feed-container"><div class="loading"><i class="fas fa-spinner"></i><p>Loading feeds...</p></div></div>
        </section>
        <section>
          <h2><i class="fas fa-exclamation-triangle"></i> Active Threats</h2>
          <div id="activeThreatCards" style="max-height:700px;overflow-y:auto"></div>
        </section>
        <section>
          <h2><i class="fas fa-chart-line"></i> Metrics</h2>
          <div id="threatMetrics"><div class="threat-card medium"><h4>Ransomware (Nov 2025)</h4><div class="description"><strong>727 attacks</strong> globally, <strong>22% increase</strong> YoY.</div><div class="action"><strong>Top Groups:</strong> Qilin (15%), Clop (15%)</div></div></div>
        </section>
      </div>
    </div>
    <div id="tab-hypothesis" class="tab-content"><section><h2><i class="fas fa-brain"></i> AI Hypothesis Generator</h2><button class="primary" onclick="generateHypothesis()" style="width:100%;padding:.875rem"><i class="fas fa-radiation"></i> Generate Hypotheses</button><div id="hypothesisLoading" class="loading" style="display:none"><i class="fas fa-spinner"></i><p>Generating...</p></div><div id="hypothesisContainer" style="margin-top:1.5rem"></div></section></div>
    <div id="tab-osint" class="tab-content"><section><h2><i class="fas fa-keyboard"></i> OSINT Tools</h2><div class="alert"><i class="fas fa-info-circle"></i><span>Press any key (A-Z) or click to instantly open that OSINT tool in a new tab. Perfect for rapid IOC investigation.</span></div><div id="osintKeyboard" class="osint-keyboard"></div></section></div>
    <div id="tab-ioc" class="tab-content"><div class="grid"><section><h2><i class="fas fa-fingerprint"></i> IOC Extractor</h2><textarea id="iocInput" placeholder="Paste intel here..."></textarea><button class="primary" onclick="extractIOCs()" style="width:100%;margin-top:.75rem"><i class="fas fa-search-plus"></i> Extract</button></section><section><h2><i class="fas fa-list"></i> Extracted IOCs</h2><div id="iocResults" class="ioc-list"><p style="color:var(--text-tertiary);text-align:center;padding:2rem 0">IOCs will appear here...</p></div></section></div></div>
    <div id="tab-translator" class="tab-content"><div class="grid"><section><h2><i class="fas fa-language"></i> Query Translator</h2><select id="sourcePlatform"><option value="kql">Sentinel (KQL)</option><option value="spl">Splunk (SPL)</option></select><select id="targetPlatform"><option value="spl">Splunk (SPL)</option><option value="kql">Sentinel (KQL)</option></select><textarea id="sourceQuery" placeholder="Enter query..."></textarea><button class="primary" onclick="translateQuery()" style="width:100%;margin-top:.75rem"><i class="fas fa-exchange-alt"></i> Translate</button></section><section><h2><i class="fas fa-code"></i> Result</h2><pre id="translatedQuery">Translation appears here...</pre></section></div></div>
    <div id="tab-queries" class="tab-content"><div class="grid"><section class="grid-full"><h2><i class="fas fa-code"></i> Detection Queries</h2><select id="technique" onchange="showDetectionQuery()"><option value="">-- Select MITRE Technique --</option><option value="T1059">T1059 - Command Interpreter</option><option value="T1566">T1566 - Phishing</option></select><pre id="queryOutput">Select a technique...</pre></section></div></div>
  </div>

  <footer><div><strong>CyberGator1</strong> - Threat Hunting Command Center</div><div style="margin-top:.5rem">Created by Pratik</div></footer>

  <script>
let currentTab='intel';
let allArticles=[];
const detections={T1059:`Microsoft Sentinel (KQL):\nDeviceProcessEvents | where FileName in~ ("powershell.exe", "cmd.exe")\n\nSplunk (SPL):\nindex=windows EventCode=4688 NewProcessName="*powershell.exe"`,T1566:`Microsoft Sentinel (KQL):\nEmailEvents | where Subject has_any ("urgent", "invoice")`};

function switchTab(tab){document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active'));document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));document.getElementById('tab-'+tab).classList.add('active');event.target.classList.add('active');currentTab=tab;if(tab==='osint'&&!document.getElementById('osintKeyboard').innerHTML)loadOSINTKeyboard();}

function showDetectionQuery(){document.getElementById('queryOutput').textContent=detections[document.getElementById('technique').value]||'Select a technique...';}

function loadActiveThreatCards(){document.getElementById('activeThreatCards').innerHTML=`<div class="threat-card critical"><h4>Qilin & Clop Ransomware (Dec 2025)</h4><div class="description">15% of global attacks each</div><div class="action"><strong>Action:</strong> Monitor Oracle EBS</div></div><div class="threat-card high"><h4>Warlock Ransomware</h4><div class="description">SharePoint zero-day exploitation</div><div class="action"><strong>Action:</strong> Patch SharePoint</div></div>`;}

const rssFeeds=['https://www.bleepingcomputer.com/feed/','https://feeds.feedburner.com/TheHackersNews','https://krebsonsecurity.com/feed/','https://www.securityweek.com/feed/','https://www.darkreading.com/rss.xml'];

async function fetchFeed(url){try{const resp=await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}`);const data=await resp.json();if(data.status==='ok'){return data.items.slice(0,10).map(item=>({title:item.title||'No title',link:item.link||'#',pubDate:item.pubDate||'',description:(item.description||'').replace(/<[^>]+>/g,'').slice(0,450),source:new URL(url).hostname,tags:autoTagArticle(item.title+' '+item.description)}));}return[];}catch(e){return[];}}

async function loadFeeds(){const area=document.getElementById('feedArea');area.innerHTML='<div class="loading"><i class="fas fa-spinner"></i><p>Loading...</p></div>';allArticles=[];const results=await Promise.all(rssFeeds.map(f=>fetchFeed(f)));results.forEach(items=>allArticles.push(...items));allArticles.sort((a,b)=>new Date(b.pubDate)-new Date(a.pubDate));applyFeedFilters();}

function autoTagArticle(text){const lower=text.toLowerCase();const tags=[];if(lower.match(/ransom|lockbit|blackcat|qilin|clop/))tags.push({name:'Ransomware',type:'critical'});if(lower.match(/zero.?day/))tags.push({name:'Zero-Day',type:'critical'});if(lower.match(/apt\d+|apt\s/))tags.push({name:'APT',type:'high'});if(lower.match(/phish/))tags.push({name:'Phishing',type:'high'});if(lower.match(/malware/))tags.push({name:'Malware',type:'high'});return tags;}

function applyFeedFilters(){const timeFilter=document.getElementById('feedFilter').value;const searchTerm=document.getElementById('feedSearch').value.toLowerCase();let filtered=allArticles;if(timeFilter!=='all'){const now=new Date();filtered=filtered.filter(article=>{const articleDate=new Date(article.pubDate);const diff=now-articleDate;switch(timeFilter){case'today':return now.toDateString()===articleDate.toDateString();case'24h':return diff<=86400000;case'7d':return diff<=604800000;default:return true;}});}if(searchTerm){filtered=filtered.filter(a=>(a.title+a.description).toLowerCase().includes(searchTerm));}displayFeeds(filtered.slice(0,50));}

function displayFeeds(articles){const area=document.getElementById('feedArea');if(!articles.length){area.innerHTML='<p style="text-align:center;color:var(--text-tertiary);padding:2rem 0">No articles found.</p>';return;}area.innerHTML=articles.map(a=>`<div class="feed-item"><a href="${a.link}" target="_blank" rel="noopener">${a.title}</a>${a.description?`<div class="description">${a.description}</div>`:''}<div class="meta"><span><i class="fas fa-clock"></i> ${getTimeAgo(new Date(a.pubDate))}</span><span><i class="fas fa-globe"></i> ${a.source}</span></div>${a.tags.length?`<div class="tags">${a.tags.map(t=>`<span class="tag ${t.type}">${t.name}</span>`).join('')}</div>`:''}</div>`).join('');}

function getTimeAgo(date){const seconds=Math.floor((new Date()-date)/1000);if(seconds<3600)return Math.floor(seconds/60)+'m ago';if(seconds<86400)return Math.floor(seconds/3600)+'h ago';if(seconds<604800)return Math.floor(seconds/86400)+'d ago';return date.toLocaleDateString();}

function generateHypothesis(){const container=document.getElementById('hypothesisContainer');const loading=document.getElementById('hypothesisLoading');if(!allArticles.length){alert('Please wait for feeds to load first.');return;}loading.style.display='block';container.innerHTML='';setTimeout(()=>{loading.style.display='none';const templates=[{title:a=>`Hunt for shadow IT exploiting "${a.title.slice(0,50)}..."`,hypothesis:a=>'Adversaries may abuse this incident to exfiltrate data via unsanctioned cloud services. Monitor unusual outbound connections to file-sharing platforms.',context:a=>`<strong>Threat Context:</strong> Employees may bypass security controls during ${new Date(a.pubDate).toLocaleDateString()}<br><strong>TTPs:</strong> Data Exfiltration (T1041), Cloud Service Abuse (T1567)<br><strong>Hunt Query:</strong> DeviceNetworkEvents | where RemoteUrl has_any ("dropbox","drive.google","mega.nz")`},{title:a=>`Investigate if "${a.title.slice(0,50)}..." masks APT activity`,hypothesis:a=>'This high-profile event may hide stealthier targeted attacks. Threat actors leverage breaking news to blend malicious C2 traffic with legitimate communications.',context:a=>`<strong>Threat Context:</strong> APT groups capitalize on media attention to hide infrastructure<br><strong>TTPs:</strong> Command and Control (T1071), Obfuscation (T1027)<br><strong>Hunt Query:</strong> Look for beaconing patterns in proxy logs coinciding with ${new Date(a.pubDate).toLocaleDateString()}`},{title:a=>`Hunt for phishing campaigns weaponizing "${a.title.slice(0,50)}..."`,hypothesis:a=>'Attackers rapidly weaponize breaking security news into phishing lures. Expect surge in themed credential harvesting within 24-48 hours of this disclosure.',context:a=>`<strong>Threat Context:</strong> Phishing activity peaks immediately following major security incidents<br><strong>TTPs:</strong> Spearphishing (T1566), Credential Harvesting<br><strong>Hunt Query:</strong> EmailEvents | where Subject contains keywords from article AND TimeGenerated > ago(48h)`},{title:a=>`Investigate supply chain risk from "${a.title.slice(0,50)}..."`,hypothesis:a=>'Third-party vendors mentioned in this article may be compromised, creating cascading supply chain risk to your organization and partners.',context:a=>`<strong>Threat Context:</strong> Breaches disclosed on ${new Date(a.pubDate).toLocaleDateString()} often have upstream/downstream impacts<br><strong>TTPs:</strong> Supply Chain Compromise (T1195)<br><strong>Hunt Query:</strong> Monitor vendor-related authentication events and data flows`},{title:a=>`Probe for insider threats amplifying "${a.title.slice(0,50)}..."`,hypothesis:a=>'Internal actors may exploit this external distraction to exfiltrate sensitive data while security teams are focused on the publicized threat.',context:a=>`<strong>Threat Context:</strong> Insider threat activity increases during major security events<br><strong>TTPs:</strong> Data Staged (T1074), Removable Media (T1052)<br><strong>Hunt Query:</strong> Monitor USB connections, after-hours file access, and unusual SharePoint downloads`}];const hypotheses=allArticles.slice(0,10).map((a,i)=>{const template=templates[i%templates.length];return{title:template.title(a),hypothesis:template.hypothesis(a),context:template.context(a)};});container.innerHTML=hypotheses.map((h,i)=>`<div class="hypothesis-item"><h4>${i+1}. ${h.title}</h4><p><strong>Hypothesis:</strong> ${h.hypothesis}</p><div class="context">${h.context}</div></div>`).join('');},1500);}

const osintTools=[{key:'A',name:'AbuseIPDB',url:'https://www.abuseipdb.com/check'},{key:'B',name:'BGPView',url:'https://bgpview.io'},{key:'C',name:'Censys',url:'https://search.censys.io'},{key:'D',name:'DNSTrails',url:'https://securitytrails.com/domain'},{key:'E',name:'IPVoid',url:'https://www.ipvoid.com/domain-reputation-check/'},{key:'F',name:'Fofa',url:'https://en.fofa.info'},{key:'G',name:'GreyNoise',url:'https://viz.greynoise.io/query'},{key:'H',name:'Hybrid Analysis',url:'https://www.hybrid-analysis.com'},{key:'I',name:'IPinfo',url:'https://ipinfo.io/'},{key:'J',name:'JoeSandbox',url:'https://www.joesandbox.com'},{key:'K',name:'Kaspersky TI',url:'https://opentip.kaspersky.com'},{key:'L',name:'DNSlytics',url:'https://dnslytics.com/'},{key:'M',name:'Maltiverse',url:'https://www.maltiverse.com/search'},{key:'N',name:'Netlas',url:'https://app.netlas.io'},{key:'O',name:'Onyphe',url:'https://www.onyphe.io'},{key:'P',name:'Pulsedive',url:'https://pulsedive.com'},{key:'Q',name:'Talos Intel',url:'https://www.talosintelligence.com/reputation_center'},{key:'R',name:'AlienVault OTX',url:'https://otx.alienvault.com'},{key:'S',name:'Shodan',url:'https://www.shodan.io/search'},{key:'T',name:'ThreatFox',url:'https://threatfox.abuse.ch'},{key:'U',name:'URLScan',url:'https://urlscan.io'},{key:'V',name:'VirusTotal',url:'https://www.virustotal.com/gui/home/upload'},{key:'W',name:'WHOIS',url:'https://whois.domaintools.com'},{key:'X',name:'X-Force',url:'https://exchange.xforce.ibmcloud.com'},{key:'Y',name:'YARAify',url:'https://yaraify.abuse.ch'},{key:'Z',name:'ZoomEye',url:'https://www.zoomeye.org'}];

function loadOSINTKeyboard(){document.getElementById('osintKeyboard').innerHTML=osintTools.map(t=>`<a href="${t.url}" target="_blank" class="osint-key" accesskey="${t.key.toLowerCase()}"><div class="letter">${t.key}</div><div class="tool-name">${t.name}</div></a>`).join('');}

document.addEventListener('keydown',e=>{if(currentTab==='osint'&&e.key.match(/[a-z]/i)&&!e.ctrlKey&&!e.altKey&&!e.metaKey){const tool=osintTools.find(t=>t.key.toLowerCase()===e.key.toLowerCase());if(tool){window.open(tool.url,'_blank');e.preventDefault();}}});

let extractedIOCs={ips:[],domains:[],urls:[],hashes:[]};

function extractIOCs(){const text=document.getElementById('iocInput').value;if(!text.trim()){alert('Please paste text first.');return;}extractedIOCs={ips:[],domains:[],urls:[],hashes:[]};extractedIOCs.ips=[...new Set(text.match(/\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b/g)||[])];extractedIOCs.domains=[...new Set(text.match(/\b(?:[a-z0-9-]+\.)+[a-z]{2,}\b/gi)||[])].filter(d=>!extractedIOCs.ips.includes(d));extractedIOCs.urls=[...new Set(text.match(/https?:\/\/[^\s<>"]+/gi)||[])];extractedIOCs.hashes=[...new Set(text.match(/\b[a-f0-9]{32,64}\b/gi)||[])];const results=document.getElementById('iocResults');let html='';let total=0;const addSection=(title,items,type)=>{if(items.length){html+=`<div style="margin-bottom:1rem"><strong>${title} (${items.length})</strong></div>`;items.forEach(item=>{html+=`<div class="ioc-item"><code style="word-break:break-all;color:var(--text-secondary);font-size:.8125rem">${item}</code><span class="ioc-type">${type}</span></div>`;});total+=items.length;}};addSection('IP Addresses',extractedIOCs.ips,'IP');addSection('Domains',extractedIOCs.domains,'DOMAIN');addSection('URLs',extractedIOCs.urls,'URL');addSection('Hashes',extractedIOCs.hashes,'HASH');results.innerHTML=html||'<p style="text-align:center;color:var(--text-tertiary);padding:2rem 0">No IOCs found.</p>';if(total>0){results.innerHTML=`<div style="background:var(--success-light);color:var(--success);padding:.75rem;border-radius:var(--radius);margin-bottom:1rem;text-align:center;font-weight:500;border:1px solid var(--success)">Extracted ${total} IOCs</div>`+results.innerHTML;}}

function translateQuery(){const source=document.getElementById('sourcePlatform').value;const target=document.getElementById('targetPlatform').value;const query=document.getElementById('sourceQuery').value;if(!query.trim()){alert('Please enter a query.');return;}let translated=query;if(source==='kql'&&target==='spl'){translated=query.replace(/\| where/g,'| search').replace(/\| project/g,'| table');}else if(source==='spl'&&target==='kql'){translated=query.replace(/\| search/g,'| where').replace(/\| table/g,'| project');}document.getElementById('translatedQuery').textContent=translated;}

setInterval(()=>{document.getElementById('clock').textContent=new Date().toLocaleString('en-US',{weekday:'short',year:'numeric',month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'});},1000);

window.addEventListener('load',()=>{showDetectionQuery();loadFeeds();loadActiveThreatCards();});
  </script>
</body>
</html>